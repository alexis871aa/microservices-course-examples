# Weather Bot üå§Ô∏è

–ü—Ä–æ—Å—Ç–æ–π Telegram –±–æ—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–≥–æ–¥–µ –≤ –ª—é–±–æ–º –≥–æ—Ä–æ–¥–µ –º–∏—Ä–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ Open-Meteo API.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üåç **–ü–æ–≥–æ–¥–∞ –≤ –ª—é–±–æ–º –≥–æ—Ä–æ–¥–µ** - `/weather <–≥–æ—Ä–æ–¥>`
- üèôÔ∏è **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≥–æ—Ä–æ–¥–∞** - –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫—Ä—É–ø–Ω—ã–º –≥–æ—Ä–æ–¥–∞–º –†–æ—Å—Å–∏–∏
- ‚ö° **Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã** - —É–¥–æ–±–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏
- üé® **–ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ** - —ç–º–æ–¥–∑–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ø–æ–≥–æ–¥—ã
- üîÑ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –∫–Ω–æ–ø–∫–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- üÜì **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ** - –±–µ–∑ API –∫–ª—é—á–µ–π –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

## –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **–í–Ω–µ—à–Ω–∏–µ API** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Open-Meteo (Geocoding + Weather)
- **HTTP –∑–∞–ø—Ä–æ—Å—ã** - —Ä–∞–±–æ—Ç–∞ —Å REST API
- **JSON –ø–∞—Ä—Å–∏–Ω–≥** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ API
- **Graceful shutdown** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
- **Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UX –≤ Telegram
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥** - –º–µ—Ç–æ–¥—ã –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ, —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- **WMO –∫–æ–¥—ã –ø–æ–≥–æ–¥—ã** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–¥—ã –í—Å–µ–º–∏—Ä–Ω–æ–π –º–µ—Ç–µ–æ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot API

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–æ–º–∞–Ω–¥

–í Telegram –±–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π:

```go
// –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
b.RegisterHandler(bot.HandlerTypeMessageText, "/start", bot.MatchTypeExact, wb.startHandler)
b.RegisterHandler(bot.HandlerTypeMessageText, "/weather", bot.MatchTypePrefix, wb.weatherHandler)
b.RegisterHandler(bot.HandlerTypeMessageText, "/popular", bot.MatchTypeExact, wb.popularCitiesHandler)
b.RegisterHandler(bot.HandlerTypeCallbackQueryData, "", bot.MatchTypePrefix, wb.callbackHandler)
```

**–¢–∏–ø—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:**
- `HandlerTypeMessageText` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `HandlerTypeCallbackQueryData` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ inline –∫–Ω–æ–ø–∫–∏

**–¢–∏–ø—ã —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è:**
- `MatchTypeExact` - —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ "/start")
- `MatchTypePrefix` - —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, "/weather –ú–æ—Å–∫–≤–∞")

### Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ Callback'–∏

#### –°–æ–∑–¥–∞–Ω–∏–µ inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

```go
keyboard := &models.InlineKeyboardMarkup{
    InlineKeyboard: [][]models.InlineKeyboardButton{
        {
            {Text: "üåç –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≥–æ—Ä–æ–¥–∞", CallbackData: "popular_cities"},
        },
        {
            {Text: "üîÑ –û–±–Ω–æ–≤–∏—Ç—å", CallbackData: "weather_" + city},
            {Text: "üåç –î—Ä—É–≥–∏–µ –≥–æ—Ä–æ–¥–∞", CallbackData: "popular_cities"},
        },
    },
}
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `InlineKeyboard` - –¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ –∫–Ω–æ–ø–æ–∫ (—Ä—è–¥—ã –∏ —Å—Ç–æ–ª–±—Ü—ã)
- `Text` - —Ç–µ–∫—Å—Ç, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–π –Ω–∞ –∫–Ω–æ–ø–∫–µ
- `CallbackData` - –¥–∞–Ω–Ω—ã–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ (–¥–æ 64 –±–∞–π—Ç)

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ callback'–æ–≤

```go
func (wb *WeatherBot) callbackHandler(ctx context.Context, b *bot.Bot, update *models.Update) {
    callback := update.CallbackQuery
    data := callback.Data // –ü–æ–ª—É—á–∞–µ–º CallbackData

    // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–≤–µ—á–∞–µ–º –Ω–∞ callback query
    b.AnswerCallbackQuery(ctx, &bot.AnswerCallbackQueryParams{
        CallbackQueryID: callback.ID,
    })

    // –ü–æ–ª—É—á–∞–µ–º chat ID –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è
    if callback.Message.Message == nil {
        return // –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
    }
    chatID := callback.Message.Message.Chat.ID

    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    if data == "popular_cities" {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –≥–æ—Ä–æ–¥–∞
    } else if strings.HasPrefix(data, "weather_") {
        city := strings.TrimPrefix(data, "weather_")
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–≥–æ–¥—É –¥–ª—è –≥–æ—Ä–æ–¥–∞
    }
}
```

**–í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- –í—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–π—Ç–µ `AnswerCallbackQuery` - –∏–Ω–∞—á–µ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥–µ—Ç "–∫—Ä—É—Ç–∏—Ç—å—Å—è" –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
- `callback.Message` –º–æ–∂–µ—Ç –±—ã—Ç—å `MaybeInaccessibleMessage` - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- `CallbackData` –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ 64 –±–∞–π—Ç–∞–º–∏ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã

#### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

```go
// –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å –Ω–æ–≤–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
b.EditMessageText(ctx, &bot.EditMessageTextParams{
    ChatID:      chatID,
    MessageID:   loadingMsg.ID,
    Text:        weatherText,
    ReplyMarkup: keyboard,
})
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ.

## –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö API

### –ö–∞–∫ –∏–∑—É—á–∏—Ç—å API —Å –Ω—É–ª—è

#### 1. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

**Open-Meteo Geocoding API:**
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://open-meteo.com/en/docs/geocoding-api
- Endpoint: `https://geocoding-api.open-meteo.com/v1/search`

**Open-Meteo Weather API:**
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://open-meteo.com/en/docs
- Endpoint: `https://api.open-meteo.com/v1/forecast`

#### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ curl

```bash
# –ü–æ–∏—Å–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≥–æ—Ä–æ–¥–∞
curl "https://geocoding-api.open-meteo.com/v1/search?name=Moscow&count=1&language=ru&format=json"

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
curl "https://api.open-meteo.com/v1/forecast?latitude=55.7558&longitude=37.6176&current=temperature_2m,apparent_temperature,relative_humidity_2m,weather_code,surface_pressure,wind_speed_10m,wind_direction_10m&timezone=auto"
```

#### 3. –ê–Ω–∞–ª–∏–∑ JSON –æ—Ç–≤–µ—Ç–æ–≤

**Geocoding API –æ—Ç–≤–µ—Ç:**
```json
{
  "results": [
    {
      "id": 524901,
      "name": "Moscow",
      "latitude": 55.75222,
      "longitude": 37.61556,
      "elevation": 144.0,
      "feature_code": "PPLC",
      "country_code": "RU",
      "admin1_id": 524894,
      "admin2_id": 524901,
      "admin3_id": 524901,
      "timezone": "Europe/Moscow",
      "population": 10381222,
      "country_id": 2017370,
      "country": "Russia",
      "admin1": "Moscow",
      "admin2": "Moscow",
      "admin3": "Moscow"
    }
  ],
  "generationtime_ms": 1.2345
}
```

**Weather API –æ—Ç–≤–µ—Ç:**
```json
{
  "latitude": 55.75,
  "longitude": 37.625,
  "generationtime_ms": 0.123,
  "utc_offset_seconds": 10800,
  "timezone": "Europe/Moscow",
  "timezone_abbreviation": "MSK",
  "elevation": 144.0,
  "current_units": {
    "time": "iso8601",
    "interval": "seconds",
    "temperature_2m": "¬∞C",
    "apparent_temperature": "¬∞C",
    "relative_humidity_2m": "%",
    "weather_code": "wmo code",
    "surface_pressure": "hPa",
    "wind_speed_10m": "m/s",
    "wind_direction_10m": "¬∞"
  },
  "current": {
    "time": "2024-01-15T12:00",
    "interval": 900,
    "temperature_2m": -5.2,
    "apparent_temperature": -8.1,
    "relative_humidity_2m": 87,
    "weather_code": 3,
    "surface_pressure": 1013.2,
    "wind_speed_10m": 3.4,
    "wind_direction_10m": 245
  }
}
```

#### 4. –°–æ–∑–¥–∞–Ω–∏–µ Go —Å—Ç—Ä—É–∫—Ç—É—Ä

–ù–∞ –æ—Å–Ω–æ–≤–µ JSON –æ—Ç–≤–µ—Ç–æ–≤ —Å–æ–∑–¥–∞–µ–º Go —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```go
// –î–ª—è Geocoding API
type GeocodingResponse []struct {
    Name      string  `json:"name"`
    Country   string  `json:"country"`
    Latitude  float64 `json:"latitude"`
    Longitude float64 `json:"longitude"`
}

// –î–ª—è Weather API
type WeatherResponse struct {
    Current struct {
        Time                string  `json:"time"`
        Temperature2m       float64 `json:"temperature_2m"`
        ApparentTemperature float64 `json:"apparent_temperature"`
        RelativeHumidity2m  int     `json:"relative_humidity_2m"`
        WeatherCode         int     `json:"weather_code"`
        SurfacePressure     float64 `json:"surface_pressure"`
        WindSpeed10m        float64 `json:"wind_speed_10m"`
        WindDirection10m    float64 `json:"wind_direction_10m"`
    } `json:"current"`
}
```

#### 5. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è API

**–û–Ω–ª–∞–π–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- **Postman** - GUI –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API
- **Insomnia** - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Postman
- **HTTPie** - –∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- **JSON Formatter** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ JSON

**–ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- –ü—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤—å—Ç–µ URL –≤ –±—Ä–∞—É–∑–µ—Ä –¥–ª—è GET –∑–∞–ø—Ä–æ—Å–æ–≤
- Developer Tools (F12) ‚Üí Network –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

**Go –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
```go
// –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ - –≤—ã–≤–æ–¥–∏–º —Å—ã—Ä–æ–π JSON
var raw json.RawMessage
json.NewDecoder(resp.Body).Decode(&raw)
fmt.Printf("Raw JSON: %s\n", raw)
```

#### 6. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API

```go
// –ü—Ä–æ–≤–µ—Ä—è–µ–º HTTP —Å—Ç–∞—Ç—É—Å
if resp.StatusCode != http.StatusOK {
    body, _ := io.ReadAll(resp.Body)
    return fmt.Errorf("API error %d: %s", resp.StatusCode, body)
}

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞
if len(geocoding.Results) == 0 {
    return fmt.Errorf("city not found")
}
```

### WMO Weather Codes

Open-Meteo –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–¥—ã WMO (–í—Å–µ–º–∏—Ä–Ω–∞—è –º–µ—Ç–µ–æ—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è):

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| 0 | –Ø—Å–Ω–æ |
| 1 | –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —è—Å–Ω–æ |
| 2 | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å |
| 3 | –ü–∞—Å–º—É—Ä–Ω–æ |
| 45, 48 | –¢—É–º–∞–Ω |
| 51, 53, 55 | –ú–æ—Ä–æ—Å—å |
| 61, 63, 65 | –î–æ–∂–¥—å |
| 71, 73, 75 | –°–Ω–µ–≥ |
| 95 | –ì—Ä–æ–∑–∞ |
| 96, 99 | –ì—Ä–æ–∑–∞ —Å –≥—Ä–∞–¥–æ–º |

–ü–æ–ª–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞: https://open-meteo.com/en/docs#weathervariables

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Telegram –±–æ—Ç–∞
1. –ù–∞–π–¥–∏—Ç–µ @BotFather –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–∞ –≤ –∫–æ–¥–µ
–û—Ç–∫—Ä–æ–π—Ç–µ `cmd/main.go` –∏ –∑–∞–º–µ–Ω–∏—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É:

```go
const (
    // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω –æ—Ç @BotFather
    telegramBotToken = "1234567890:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
)
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** API –∫–ª—é—á –¥–ª—è –ø–æ–≥–æ–¥—ã –Ω–µ –Ω—É–∂–µ–Ω! Open-Meteo –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
cd week_5/telegram/weather-bot
go mod tidy
```

## –ó–∞–ø—É—Å–∫

```bash
# –ò–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ weather-bot
go run cmd/main.go

# –ò–ª–∏ —Å–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ
go build -o weather-bot cmd/main.go
./weather-bot
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã
- `/start` - –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –ø–æ–º–æ—â—å
- `/weather <–≥–æ—Ä–æ–¥>` - –ø–æ–ª—É—á–∏—Ç—å –ø–æ–≥–æ–¥—É –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞
- `/popular` - –ø–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫–∏ —Å –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ –≥–æ—Ä–æ–¥–∞–º–∏

### –ü—Ä–∏–º–µ—Ä—ã
```
/weather –ú–æ—Å–∫–≤–∞
/weather London
/weather New York
/weather –¢–æ–∫–∏–æ
```

### Inline –∫–Ω–æ–ø–∫–∏
- üåç **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≥–æ—Ä–æ–¥–∞** - –±—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞
- üîÑ **–û–±–Ω–æ–≤–∏—Ç—å** - –ø–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ
- üèôÔ∏è **–ì–æ—Ä–æ–¥–∞** - –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
WeatherBot
‚îú‚îÄ‚îÄ Telegram Bot API (go-telegram/bot)
‚îú‚îÄ‚îÄ Open-Meteo Geocoding API (–ø–æ–∏—Å–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≥–æ—Ä–æ–¥–∞)
‚îú‚îÄ‚îÄ Open-Meteo Weather API (–¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ)
‚îî‚îÄ‚îÄ Graceful Shutdown
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **WeatherBot struct** - –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–æ—Ç–∞
2. **Geocoding Integration** - –ø–æ–∏—Å–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≥–æ—Ä–æ–¥–∞ —á–µ—Ä–µ–∑ Open-Meteo
3. **Weather API Integration** - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ
4. **Message Handlers** - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ callback'–æ–≤
5. **UI Components** - inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
6. **WMO Weather Codes** - –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∫–æ–¥–æ–≤ –ø–æ–≥–æ–¥—ã

### API Endpoints

- **Geocoding**: `https://geocoding-api.open-meteo.com/v1/search`
- **Weather**: `https://api.open-meteo.com/v1/forecast`

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö API
- Graceful degradation –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω

## –î–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ

–ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- üå°Ô∏è **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞** (—Ç–µ–∫—É—â–∞—è –∏ –æ—â—É—â–∞–µ–º–∞—è)
- üìù **–û–ø–∏—Å–∞–Ω–∏–µ** (–Ω–∞ –æ—Å–Ω–æ–≤–µ WMO –∫–æ–¥–æ–≤)
- üí® **–í–µ—Ç–µ—Ä** (—Å–∫–æ—Ä–æ—Å—Ç—å –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
- üíß **–í–ª–∞–∂–Ω–æ—Å—Ç—å**
- üìä **–î–∞–≤–ª–µ–Ω–∏–µ**
- üïê **–í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**

## –õ–æ–≥–∏

–ë–æ—Ç –≤—ã–≤–æ–¥–∏—Ç –ª–æ–≥–∏:
- –ü–æ–∏—Å–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≥–æ—Ä–æ–¥–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç API
- –û—à–∏–±–∫–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- Graceful shutdown

## –û—Å—Ç–∞–Ω–æ–≤–∫–∞

–ù–∞–∂–º–∏—Ç–µ `Ctrl+C` –¥–ª—è graceful shutdown –±–æ—Ç–∞.

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Open-Meteo

- ‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ** - –±–µ–∑ API –∫–ª—é—á–µ–π –∏ –ª–∏–º–∏—Ç–æ–≤
- ‚úÖ **–ë–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏** - —Å—Ä–∞–∑—É –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- ‚úÖ **–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å** - –¥–∞–Ω–Ω—ã–µ –æ—Ç –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –º–µ—Ç–µ–æ—Å–ª—É–∂–±
- ‚úÖ **–û—Ç–∫—Ä—ã—Ç—ã–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥** - –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- ‚úÖ **–ë—ã—Å—Ç—Ä—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å

## –†–∞—Å—à–∏—Ä–µ–Ω–∏—è

–õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å:
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ (Redis/in-memory)
- –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π (Open-Meteo –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ 16 –¥–Ω–µ–π)
- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (–¥–æ 80 –ª–µ—Ç –Ω–∞–∑–∞–¥)
- –ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ–≥–æ–¥—ã
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ–≥–æ–¥–µ
- –ì–µ–æ–ª–æ–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –≥–æ—Ä–æ–¥–∞
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (UV –∏–Ω–¥–µ–∫—Å, –∫–∞—á–µ—Å—Ç–≤–æ –≤–æ–∑–¥—É—Ö–∞, –ø—ã–ª—å—Ü–∞) 